---
import { themeConfig } from "@/config";
const { favicon } = themeConfig.site

const { title } = Astro.props
const fontStyle =
  themeConfig.global.fontStyle === "serif" ? "font-serif" : "font-sans";
const { googleAnalyticsID = '', umamiAnalyticsID = '' } = themeConfig.seo ?? {}
const { customGoogleAnalyticsJS = '', customUmamiAnalyticsJS = '' } = themeConfig.preload ?? {}
---

<html
  lang={Astro.currentLocale}
  class:list={[fontStyle, { "scroll-smooth": false }]}
  data-overlayscrollbars-initialize
>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    {favicon.toLowerCase().endsWith('.svg') && <link rel="icon" type="image/svg+xml" href={favicon} />}
    {favicon.toLowerCase().endsWith('.png') && <link rel="icon" type="image/png" href={favicon} />}
    {favicon.toLowerCase().endsWith('.ico') && <link rel="icon" type="image/x-icon" href={favicon} />}
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@500;600;700&family=Playfair+Display:wght@500;600;700&family=Inter:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <script is:inline src="/js/tailwind.js"></script>
    <script is:inline>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: "#1a1a2e",
              "primary-light": "#4a4a6a",
              secondary: "#fafafa",
              "text-color": "#1a1a2e",
              "light-text": "#6b7280",
              accent: "#e63946",
              "accent-soft": "#f4a261",
              background: "#f8f9fa",
              "card-bg": "#ffffff",
              "glass": "rgba(255, 255, 255, 0.85)",
            },
            boxShadow: {
              bento: "0 4px 24px -1px rgba(0, 0, 0, 0.06), 0 2px 8px -1px rgba(0, 0, 0, 0.04)",
              "bento-hover": "0 20px 40px -8px rgba(0, 0, 0, 0.12), 0 8px 16px -4px rgba(0, 0, 0, 0.06)",
              "soft": "0 2px 16px rgba(0, 0, 0, 0.04)",
              "glow": "0 0 40px rgba(230, 57, 70, 0.15)",
            },
            borderRadius: {
              bento: "20px",
              "bento-sm": "12px",
            },
            fontFamily: {
              snell: ["Snell-Black", "EarlySummer", "Playfair Display", "serif"],
              cormorant: ["Snell-Black", "EarlySummer", "Cormorant Garamond", "serif"],
              sans: ["Inter", "Noto Sans", "-apple-system", "BlinkMacSystemFont", "sans-serif"],
            },
            animation: {
              "fade-in": "fadeIn 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards",
              "slide-up": "slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards",
              "slide-left": "slideLeft 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards",
              "slide-right": "slideRight 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards",
              "scale-in": "scaleIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards",
              "float": "float 6s ease-in-out infinite",
              "shimmer": "shimmer 2s linear infinite",
            },
            keyframes: {
              fadeIn: {
                "0%": { opacity: "0" },
                "100%": { opacity: "1" },
              },
              slideUp: {
                "0%": { opacity: "0", transform: "translateY(20px)" },
                "100%": { opacity: "1", transform: "translateY(0)" },
              },
              slideLeft: {
                "0%": { opacity: "0", transform: "translateX(30px)" },
                "100%": { opacity: "1", transform: "translateX(0)" },
              },
              slideRight: {
                "0%": { opacity: "0", transform: "translateX(-30px)" },
                "100%": { opacity: "1", transform: "translateX(0)" },
              },
              scaleIn: {
                "0%": { opacity: "0", transform: "scale(0.95)" },
                "100%": { opacity: "1", transform: "scale(1)" },
              },
              float: {
                "0%, 100%": { transform: "translateY(0)" },
                "50%": { transform: "translateY(-10px)" },
              },
              shimmer: {
                "0%": { backgroundPosition: "-200% 0" },
                "100%": { backgroundPosition: "200% 0" },
              },
            },
          },
        },
      };
    </script>

    <style is:global>
      @font-face {
        font-family: "Snell-Black";
        src: local("Snell Roundhand");
        font-weight: 900;
      }

      @font-face {
        font-family: "EarlySummer";
        src: local("Early Summer");
        font-weight: normal;
      }

      /* 基础过渡 */
      * {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      /* 卡片动画 - 使用 GPU 加速 */
      .card-enter-left {
        transform: translate3d(-40px, 0, 0);
        opacity: 0;
      }

      .card-enter-right {
        transform: translate3d(40px, 0, 0);
        opacity: 0;
      }

      .card-exit {
        opacity: 0;
        pointer-events: none;
      }

      /* 内容区域过渡 */
      .content-area {
        will-change: opacity, transform;
      }

      .content-area.fade-out {
        opacity: 0;
        transform: translate3d(0, 16px, 0);
      }

      .content-area.fade-in {
        opacity: 1;
        transform: translate3d(0, 0, 0);
      }

      /* 隐藏滚动条 */
      .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      .scrollbar-hide::-webkit-scrollbar {
        display: none;
      }

      /* 玻璃态效果 */
      .glass-effect {
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
      }

      /* 渐变边框 */
      .gradient-border {
        position: relative;
      }

      .gradient-border::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        padding: 1px;
        background: linear-gradient(135deg, rgba(230, 57, 70, 0.3), rgba(244, 162, 97, 0.3));
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
        pointer-events: none;
      }

      /* 响应式布局 */
      @media (max-width: 768px) {
        .flex.w-screen.h-screen {
          flex-direction: column;
        }

        #leftCard {
          width: 100%;
          height: 100%;
          order: 1;
        }

        #rightCard {
          display: none;
        }

        #contentArea {
          padding: 1.5rem;
          padding-top: 2rem;
        }
      }
    </style>

    <!-- Google Analytics -->
    {googleAnalyticsID && (
      <>
        <script
          is:inline
          type="text/partytown"
          src={customGoogleAnalyticsJS || `https://www.googletagmanager.com/gtag/js?id=${googleAnalyticsID}`}
        />
        <script
          is:inline
          type="text/partytown"
          define:vars={{ googleAnalyticsID, customGoogleAnalyticsJS }}
        >
          window.dataLayer = window.dataLayer || []
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date())

          if (customGoogleAnalyticsJS) {
            gtag('config', googleAnalyticsID, {
              transport_url: new URL(customGoogleAnalyticsJS).origin,
            })
          }
          else {
            gtag('config', googleAnalyticsID)
          }
        </script>
      </>
    )}

    <!-- Umami Analytics -->
    {umamiAnalyticsID && (
      <script
        is:inline
        type="text/partytown"
        crossorigin="anonymous"
        data-website-id={umamiAnalyticsID}
        src={customUmamiAnalyticsJS || 'https://cloud.umami.is/script.js'}
        data-cache="true"
      />
    )}
  </head>

  <body class="travel-container">
    <slot />
  </body>

  <style>
    .travel-container {
      --primary: #1a1a2e;
      --primary-light: #4a4a6a;
      --secondary: #fafafa;
      --text-color: #1a1a2e;
      --light-text: #6b7280;
      --accent: #e63946;
      --accent-soft: #f4a261;
      --background: #f8f9fa;
      --card-bg: #ffffff;

      width: 100%;
      height: 100vh;
      overflow: hidden;
      position: relative;
      background: linear-gradient(135deg, #f8f9fa 0%, #eef2f7 100%);
      color: var(--text-color);
      font-family: "Inter", "Noto Sans", -apple-system, BlinkMacSystemFont, sans-serif;
      letter-spacing: -0.01em;
    }
  </style>
</html>
